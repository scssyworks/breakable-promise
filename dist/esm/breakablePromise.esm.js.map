{"version":3,"file":"breakablePromise.esm.js","sources":["../../node_modules/@babel/runtime/helpers/arrayLikeToArray.js","../../node_modules/@babel/runtime/helpers/arrayWithoutHoles.js","../../node_modules/@babel/runtime/helpers/iterableToArray.js","../../node_modules/@babel/runtime/helpers/unsupportedIterableToArray.js","../../node_modules/@babel/runtime/helpers/nonIterableSpread.js","../../node_modules/@babel/runtime/helpers/toConsumableArray.js","../../node_modules/@babel/runtime/helpers/classCallCheck.js","../../node_modules/@babel/runtime/helpers/createClass.js","../../node_modules/@babel/runtime/helpers/classPrivateFieldGet.js","../../node_modules/@babel/runtime/helpers/classPrivateFieldSet.js","../../src/helpers/index.ts","../../node_modules/is-promise/index.js","../../node_modules/@babel/runtime/helpers/defineProperty.js","../../src/EventEmitter/index.ts","../../src/Error/index.ts","../../src/index.ts"],"sourcesContent":["function _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nmodule.exports = _arrayLikeToArray;","var arrayLikeToArray = require(\"./arrayLikeToArray\");\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return arrayLikeToArray(arr);\n}\n\nmodule.exports = _arrayWithoutHoles;","function _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && Symbol.iterator in Object(iter)) return Array.from(iter);\n}\n\nmodule.exports = _iterableToArray;","var arrayLikeToArray = require(\"./arrayLikeToArray\");\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return arrayLikeToArray(o, minLen);\n}\n\nmodule.exports = _unsupportedIterableToArray;","function _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nmodule.exports = _nonIterableSpread;","var arrayWithoutHoles = require(\"./arrayWithoutHoles\");\n\nvar iterableToArray = require(\"./iterableToArray\");\n\nvar unsupportedIterableToArray = require(\"./unsupportedIterableToArray\");\n\nvar nonIterableSpread = require(\"./nonIterableSpread\");\n\nfunction _toConsumableArray(arr) {\n  return arrayWithoutHoles(arr) || iterableToArray(arr) || unsupportedIterableToArray(arr) || nonIterableSpread();\n}\n\nmodule.exports = _toConsumableArray;","function _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nmodule.exports = _classCallCheck;","function _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nmodule.exports = _createClass;","function _classPrivateFieldGet(receiver, privateMap) {\n  var descriptor = privateMap.get(receiver);\n\n  if (!descriptor) {\n    throw new TypeError(\"attempted to get private field on non-instance\");\n  }\n\n  if (descriptor.get) {\n    return descriptor.get.call(receiver);\n  }\n\n  return descriptor.value;\n}\n\nmodule.exports = _classPrivateFieldGet;","function _classPrivateFieldSet(receiver, privateMap, value) {\n  var descriptor = privateMap.get(receiver);\n\n  if (!descriptor) {\n    throw new TypeError(\"attempted to set private field on non-instance\");\n  }\n\n  if (descriptor.set) {\n    descriptor.set.call(receiver, value);\n  } else {\n    if (!descriptor.writable) {\n      throw new TypeError(\"attempted to set read only private field\");\n    }\n\n    descriptor.value = value;\n  }\n\n  return value;\n}\n\nmodule.exports = _classPrivateFieldSet;","export const setImmediateFn = typeof setImmediate === 'function'\n    ? setImmediate\n    : function (cb: () => void): void {\n        setTimeout(cb, 0);\n    };\n\nexport const isCallable = (callable: (...args: any[]) => any): boolean => {\n    return typeof callable === 'function';\n};","module.exports = isPromise;\nmodule.exports.default = isPromise;\n\nfunction isPromise(obj) {\n  return !!obj && (typeof obj === 'object' || typeof obj === 'function') && typeof obj.then === 'function';\n}\n","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","import { setImmediateFn as setImmediate } from \"../helpers\";\n\nexport class EventEmitter {\n    events = {} as { [type: string]: ((...args: any[]) => void)[] };\n    listenerId = Math.round(Math.random() * 1000000000000);\n\n    on<T = any>(eventType: string, cb: (...args: T[]) => void): EventEmitter {\n        this.events[eventType] = this.events[eventType] || [];\n        this.events[eventType].push(cb);\n        return this;\n    }\n\n    off<T = any>(eventType?: string, cb?: (...args: T[]) => void): EventEmitter {\n        if (typeof eventType !== 'string') {\n            for (const currEventType in this.events) {\n                this.events[currEventType].length = 0;\n            }\n        } else if (typeof cb !== 'function') {\n            if (this.events[eventType]) {\n                this.events[eventType].length = 0;\n                delete this.events[eventType];\n            }\n        } else if (this.events[eventType]) {\n            this.events[eventType].splice(this.events[eventType].indexOf(cb), 1);\n            if (this.events[eventType].length === 0) {\n                delete this.events[eventType];\n            }\n        }\n        return this;\n    }\n\n    once<T = any>(eventType: string, cb: (...args: T[]) => void): EventEmitter {\n        const tempCallback = (...args: T[]) => {\n            cb.apply(this, args);\n            setImmediate(() => {\n                this.off(eventType, tempCallback);\n            });\n        };\n        this.on(eventType, tempCallback);\n        return this;\n    }\n\n    emit<T = any>(eventType: string, ...args: T[]): void {\n        if (this.events[eventType]) {\n            this.events[eventType].forEach(fn => {\n                fn.apply(this, args);\n            });\n        }\n    }\n}","export class Error<T = any> {\n    _error: T | null = null;\n    isCaught = false;\n    constructor(err?: T | null) {\n        // eslint-disable-next-line\n        if (err != null) {\n            this.error = err;\n        }\n    }\n    set error(e: T | null) {\n        this._error = e;\n    }\n    get error(): T | null {\n        this.isCaught = true;\n        return this._error;\n    }\n}","import { setImmediateFn as setImmediate } from \"./helpers\";\nimport isPromise from 'is-promise';\nimport { EventEmitter } from \"./EventEmitter\";\nimport { Error } from \"./Error\";\n\nenum PromiseStates {\n    PENDING,\n    FULFILLED,\n    REJECTED,\n    BROKEN\n}\n\nenum EventTypes {\n    SUCCESS = 'promisesuccess',\n    FAILED = 'promisefailed',\n    BREAKABLE = 'promisebreak'\n}\n\ntype VoidFn = () => void;\n\ntype CallBreak = null | void | VoidFn;\n\ninterface PromiseFunction<T> {\n    (\n        resolve: (input?: T | null) => void,\n        reject: (error?: T | null) => void,\n        breakPromise?: (fn?: CallBreak) => void\n    ): void;\n}\n\ninterface Thenable<T> {\n    (result?: T | null): (T | any | BreakablePromise<T | any> | Promise<T | any>);\n}\n\ntype PromiseLike<T> = Promise<T> | BreakablePromise<T>;\n\nexport class BreakablePromise<T> {\n    #state: number;\n    #isBreakable = false;\n    #callBreak: CallBreak = null;\n    #data: T | null | undefined;\n    #error: Error<T>;\n    #emitter: EventEmitter;\n    constructor(fn: PromiseFunction<T>) {\n        this.#state = PromiseStates.PENDING;\n        this.#data = null;\n        this.#error = new Error<T>();\n        this.#emitter = new EventEmitter();\n        try {\n            fn.call(\n                this,\n                (data?: T | null) => {\n                    setImmediate(() => {\n                        if (!this.isBroken()) {\n                            this.#data = data;\n                            this.#state = PromiseStates.FULFILLED;\n                            this.#emitter.emit<T>(EventTypes.SUCCESS);\n                            this.#emitter.off(EventTypes.BREAKABLE);\n                        }\n                    });\n                },\n                (error?: T | null) => {\n                    setImmediate(() => {\n                        if (!this.isBroken()) {\n                            this.#error = new Error<T>(error);\n                            this.#state = PromiseStates.REJECTED;\n                            this.#emitter.emit<T>(EventTypes.FAILED);\n                            this.#emitter.off(EventTypes.BREAKABLE);\n                        }\n                    });\n                },\n                (cb: CallBreak) => {\n                    if (typeof cb === 'function') {\n                        this.#isBreakable = true;\n                        this.#callBreak = cb;\n                        this.#emitter.emit<VoidFn>(EventTypes.BREAKABLE, this.#callBreak);\n                    } else {\n                        this.#emitter.off(EventTypes.BREAKABLE);\n                    }\n                }\n            );\n        } catch (error) {\n            this.#state = PromiseStates.REJECTED;\n            this.#error = new Error<T>(error);\n        }\n    }\n\n    #isFullfilled = (): boolean => {\n        return this.#state === PromiseStates.FULFILLED;\n    }\n\n    #isPending = (): boolean => {\n        return this.#state === PromiseStates.PENDING;\n    }\n\n    #checkState = (\n        resolve: (result: any) => void,\n        reject: (error: any) => void,\n        fn?: Thenable<T>,\n    ): void => {\n        if (!this.isBroken()) {\n            let result: any;\n            if (typeof fn === 'function') {\n                result = fn(this.#isFullfilled() ? this.#data : this.#error.error);\n            }\n            if (isPromise(result)) {\n                (result as PromiseLike<T>).then(resolve, reject);\n                if (!this.#isFullfilled()) {\n                    (result as PromiseLike<T>).catch(reject);\n                }\n            } else if (this.#isFullfilled()) {\n                resolve(result);\n            } else {\n                reject(typeof result !== 'undefined' ? result : this.#error._error);\n            }\n        }\n    };\n\n    #callThen = (\n        resolveFn: Thenable<T>,\n        rejectFn?: Thenable<T>,\n        breakFn?: () => void\n    ): BreakablePromise<T | any> => {\n        return new BreakablePromise((resolve, reject, breakPromise) => {\n            if (!this.#isPending()) {\n                this.#checkState(resolve, reject, this.#isFullfilled() ? resolveFn : rejectFn);\n            } else {\n                const isSuccess = () => {\n                    this.#checkState(resolve, reject, resolveFn);\n                };\n                this.#emitter\n                    .once(EventTypes.SUCCESS, isSuccess)\n                    .once(EventTypes.FAILED, () => {\n                        this.#emitter.off(EventTypes.SUCCESS, isSuccess);\n                        this.#checkState(resolve, reject, rejectFn);\n                    });\n            }\n            if (typeof breakPromise === 'function') {\n                breakPromise(breakFn);\n            }\n        });\n    }\n\n    #callCatch = (\n        cb: Thenable<T>,\n        breakFn?: () => void\n    ): BreakablePromise<T | any> => {\n        return new BreakablePromise((resolve, reject, breakPromise) => {\n            if (!this.#isPending() && !this.#isFullfilled()) {\n                this.#checkState(resolve, reject, cb);\n            } else {\n                this.#emitter.once(EventTypes.FAILED, () => {\n                    this.#checkState(resolve, reject, cb);\n                });\n            }\n            if (typeof breakPromise === 'function') {\n                breakPromise(breakFn);\n            }\n        });\n    };\n\n    then(\n        resolveFn: Thenable<T>,\n        rejectFn?: Thenable<T>,\n        breakFn?: () => void\n    ): BreakablePromise<T | any> {\n        return this.#callThen(resolveFn, rejectFn, breakFn);\n    }\n\n    catch(\n        rejectFn: Thenable<T>,\n        breakFn?: () => void\n    ): BreakablePromise<T | any> {\n        return this.#callCatch(rejectFn, breakFn);\n    }\n\n    break(): BreakablePromise<any> {\n        return new BreakablePromise((resolve, reject) => {\n            if (this.#isBreakable) {\n                if (typeof this.#callBreak === 'function') {\n                    this.#callBreak();\n                    resolve();\n                } else {\n                    this.#emitter.once<VoidFn>(EventTypes.BREAKABLE, (callBreak) => {\n                        callBreak();\n                        resolve();\n                    });\n                }\n            } else {\n                reject();\n            }\n        });\n    }\n\n    isBroken(): boolean {\n        return this.#state === PromiseStates.BROKEN;\n    }\n\n    static resolve<U = any>(data: U): BreakablePromise<U> {\n        return new BreakablePromise<U>((resolve) => {\n            resolve(data);\n        });\n    }\n\n    static reject<U = any>(error: U): BreakablePromise<U> {\n        return new BreakablePromise<U>((_, reject) => {\n            reject(error);\n        });\n    }\n\n    static all<U>(promises: (Promise<U> | BreakablePromise<U>)[], breakFn?: () => void): BreakablePromise<U> {\n        return new BreakablePromise<any>((resolve, reject, breakPromise) => {\n            try {\n                const allPromises = [...promises];\n                const results: any[] = [];\n                for (const promise of allPromises) {\n                    promise.then((result: any) => {\n                        results.push(result);\n                    }).catch((error: any) => {\n                        throw new Error(error);\n                    });\n                }\n                resolve(results);\n                if (typeof breakPromise === 'function') {\n                    breakPromise(breakFn);\n                }\n            } catch (e) {\n                reject(e.message);\n            }\n        });\n    }\n}"],"names":["setImmediateFn","setImmediate","cb","setTimeout","EventEmitter","Math","round","random","eventType","events","push","currEventType","length","splice","indexOf","tempCallback","args","apply","off","on","forEach","fn","Error","err","error","e","_error","isCaught","PromiseStates","EventTypes","BreakablePromise","_classPrivateFieldGet","FULFILLED","PENDING","resolve","reject","isBroken","result","isPromise","then","resolveFn","rejectFn","breakFn","breakPromise","isSuccess","once","SUCCESS","FAILED","call","data","emit","BREAKABLE","REJECTED","callBreak","BROKEN","_","promises","allPromises","results","promise","message"],"mappings":"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"}